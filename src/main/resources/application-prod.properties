##############################################
# ? ENTORNO DE PRODUCCIÓN - AVP BACKEND
##############################################
spring.application.name=avp-backend
server.port=8090
server.servlet.context-path=/api

spring.profiles.active=prod
spring.main.banner-mode=off
spring.main.allow-bean-definition-overriding=true

##############################################
# ? ZONA HORARIA Y FORMATO DE FECHAS
##############################################
spring.jackson.time-zone=America/La_Paz
spring.jackson.date-format=yyyy-MM-dd HH:mm:ss


##############################################
# ?? CONFIGURACIÓN DE BASE DE DATOS (PostgreSQL)
##############################################
# Si usas PostgreSQL en Docker Compose:
# services:
#   db:
#     image: postgres:15
#     container_name: avp_db
#     environment:
#       - POSTGRES_USER=avp_admin
#       - POSTGRES_PASSWORD=tu_password_seguro
#       - POSTGRES_DB=avp_db
#     ports:
#       - "5432:5432"

spring.datasource.url=jdbc:postgresql://localhost:5432/avp_db
spring.datasource.username=avp_admin
spring.datasource.password=tu_password_seguro
spring.datasource.driver-class-name=org.postgresql.Driver

# Conexiones (HikariCP)
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.idle-timeout=30000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.pool-name=HikariPoolProdAVP


##############################################
# ? JPA / HIBERNATE CONFIG
##############################################
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.open-in-view=false


##############################################
# ? SEGURIDAD (JWT)
##############################################
# ?? IMPORTANTE: usa una clave generada segura (mínimo 64 caracteres)
jwt.secret=${JWT_SECRET}
jwt.expiration=86400000  # 24h en milisegundos


##############################################
# ? CORS (para acceso desde el frontend Flutter Web / App)
##############################################
spring.web.cors.allowed-origins=https://app.averapizza.com,https://averapizza.com
spring.web.cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS
spring.web.cors.allowed-headers=Authorization,Content-Type
spring.web.cors.allow-credentials=true


##############################################
# ? LOGGING
##############################################
logging.level.org.springframework=INFO
logging.level.org.hibernate.SQL=WARN
logging.level.com.avp=INFO

# Logs diarios rotativos
logging.file.name=/opt/avp/logs/avp-backend.log
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss} %-5level [%thread] %logger{36} - %msg%n
logging.logback.rollingpolicy.max-history=7
logging.logback.rollingpolicy.max-file-size=10MB


##############################################
# ? EMAIL (opcional para alertas o notificaciones)
##############################################
# spring.mail.host=smtp.gmail.com
# spring.mail.port=587
# spring.mail.username=notificaciones@averapizza.com
# spring.mail.password=clave_app
# spring.mail.properties.mail.smtp.auth=true
# spring.mail.properties.mail.smtp.starttls.enable=true


##############################################
# ? DOCKER DEPLOY / LINUX
##############################################
# Si PostgreSQL está en otro contenedor:
# spring.datasource.url=jdbc:postgresql://avp_db:5432/avp_db
#
# Si el backend está en un contenedor aparte:
# usa variables de entorno en docker-compose:
#   - SPRING_PROFILES_ACTIVE=prod
#   - JWT_SECRET=<clave segura>
#   - SPRING_DATASOURCE_PASSWORD=<tu password>
